import { baseUrl } from "@constants";
import { ImageResponse } from "next/server";

export const runtime = "edge";

export const size = {
  width: 1200,
  height: 630,
};

export const contentType = "image/png";

// See app/opengraph/[...path]/route.ts
// https://github.com/vercel/next.js/issues/49630#issuecomment-1562708047
export const getOpenGraphImageMetadata = (route: string, title: string) => ({
  ...size,
  type: contentType,
  url: `${baseUrl}/opengraph/${route}?title=${title}`,
});

export function generateOpenGraphImage(title: string) {
  // Image generation
  return new ImageResponse(
    (
      <div
        style={{
          width: "100%",
          height: "100%",
          display: "flex",
          alignItems: "center",
          justifyContent: "center",
          position: "relative",
        }}
      >
        {/* Algolia background SVG */}
        <svg
          width="1200"
          height="630"
          viewBox="0 0 1200 630"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <g clip-path="url(#clip0_1060_5545)">
            <rect width="1200" height="630" fill="white" />
            <rect
              width="1272.7"
              height="801.639"
              transform="matrix(-1 0 0 1 1238.77 -27.9025)"
              fill="url(#paint0_linear_1060_5545)"
            />
            <rect
              x="-33.9287"
              y="-27.9025"
              width="64.5259"
              height="714.843"
              fill="url(#paint1_radial_1060_5545)"
            />
            <rect
              x="-33.9287"
              y="-27.9025"
              width="64.5259"
              height="714.843"
              fill="url(#paint2_radial_1060_5545)"
            />
            <g opacity="0.1" filter="url(#filter0_f_1060_5545)">
              <path
                d="M857.491 -23.0974C669.295 -23.0974 515.877 128.815 513.161 316.595C510.404 507.299 664.953 665.326 855.464 666.43C914.295 666.775 970.962 652.367 1021.29 624.988C1026.2 622.324 1026.95 615.562 1022.78 611.864L990.549 583.27C984.002 577.46 974.684 575.817 966.62 579.24C931.498 594.199 893.329 601.845 853.989 601.362C700.047 599.471 575.673 471.239 578.126 317.133C580.552 164.972 704.941 41.9429 857.491 41.9429H1136.88V539.123L978.364 398.112C973.236 393.544 965.379 394.441 961.244 399.92C935.799 433.648 894.35 454.624 848.31 451.45C784.448 447.034 732.702 395.559 727.919 331.65C722.199 255.418 782.546 191.551 857.491 191.551C925.281 191.551 981.107 243.785 986.938 310.164C987.462 316.07 990.122 321.576 994.547 325.509L1035.83 362.149C1040.52 366.303 1047.95 363.764 1049.1 357.595C1052.08 341.656 1053.13 325.054 1051.96 308.025C1045.31 210.954 966.772 132.859 869.772 126.883C758.561 120.024 665.587 207.117 662.637 316.291C659.756 422.69 746.831 514.406 853.121 516.753C897.492 517.732 938.624 503.767 971.858 479.561L1178.98 663.38C1187.86 671.26 1201.88 664.953 1201.88 653.071V-10.0424C1201.88 -17.2737 1196.03 -23.125 1188.81 -23.125H857.491V-23.0974Z"
                fill="url(#paint3_radial_1060_5545)"
              />
            </g>
            <rect
              x="-33.9287"
              y="-27.9025"
              width="64.5259"
              height="714.843"
              fill="url(#paint4_radial_1060_5545)"
            />
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M223.823 120.652V93.8629C223.823 93.5019 223.501 93.2274 223.145 93.2831L218.127 94.0727C217.842 94.1175 217.631 94.3641 217.631 94.6535L217.648 121.823C217.648 123.108 217.648 131.042 227.192 131.319C227.523 131.329 227.797 131.063 227.797 130.732V126.676C227.797 126.382 227.579 126.128 227.288 126.096C223.822 125.697 223.822 121.365 223.822 120.654L223.823 120.652Z"
              fill="#003DFF"
            />
            <path
              d="M306.578 103.691H301.529C301.205 103.691 300.942 103.954 300.942 104.278V130.74C300.942 131.064 301.205 131.326 301.529 131.326H306.578C306.902 131.326 307.165 131.064 307.165 130.74V104.278C307.165 103.954 306.902 103.691 306.578 103.691Z"
              fill="#003DFF"
            />
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M301.529 100.373H306.577C306.902 100.373 307.164 100.111 307.164 99.7867V93.8629C307.164 93.5029 306.842 93.2274 306.486 93.2831L301.437 94.0737C301.152 94.1184 300.941 94.3641 300.941 94.6534V99.7867C300.941 100.111 301.203 100.373 301.528 100.373H301.529Z"
              fill="#003DFF"
            />
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M292.802 120.652V93.8629C292.802 93.5019 292.48 93.2274 292.124 93.2831L287.106 94.0727C286.82 94.1175 286.61 94.3641 286.61 94.6535L286.627 121.823C286.627 123.108 286.627 131.042 296.17 131.319C296.501 131.329 296.776 131.063 296.776 130.732V126.676C296.776 126.382 296.558 126.128 296.267 126.096C292.801 125.697 292.801 121.365 292.801 120.654L292.802 120.652Z"
              fill="#003DFF"
            />
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M279.668 107.469C278.56 106.251 277.199 105.316 275.613 104.654C274.03 104.004 272.305 103.674 270.435 103.674C268.567 103.674 266.84 103.989 265.272 104.654C263.721 105.316 262.359 106.25 261.218 107.469C260.078 108.685 259.192 110.141 258.557 111.847C257.923 113.555 257.638 115.564 257.638 117.651C257.638 119.738 257.955 121.317 258.588 123.042C259.222 124.764 260.094 126.235 261.218 127.453C262.341 128.669 263.687 129.603 265.256 130.283C266.824 130.962 269.245 131.31 270.466 131.325C271.685 131.325 274.124 130.945 275.707 130.283C277.29 129.619 278.637 128.669 279.762 127.453C280.885 126.235 281.756 124.764 282.373 123.042C282.991 121.317 283.292 119.738 283.292 117.651C283.292 115.564 282.96 113.555 282.294 111.847C281.66 110.14 280.789 108.685 279.666 107.469H279.668ZM275.25 123.753C274.109 125.319 272.509 126.11 270.467 126.11C268.424 126.11 266.825 125.334 265.684 123.753C264.544 122.186 263.973 120.371 263.973 117.667C263.973 114.993 264.529 112.78 265.669 111.216C266.808 109.65 268.408 108.877 270.45 108.877C272.493 108.877 274.092 109.651 275.232 111.216C276.372 112.764 276.958 114.993 276.958 117.667C276.958 120.371 276.389 122.172 275.249 123.753H275.25Z"
              fill="#003DFF"
            />
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M206.325 103.691H201.42C196.611 103.691 192.379 106.225 189.909 110.065C188.465 112.311 187.623 115.001 187.623 117.895C187.623 122.359 189.625 126.339 192.753 128.943C193.045 129.201 193.355 129.438 193.679 129.653C194.958 130.497 196.474 130.992 198.106 130.992C198.229 130.992 198.351 130.989 198.472 130.983C198.508 130.981 198.543 130.978 198.579 130.976C198.665 130.971 198.753 130.965 198.839 130.957C198.873 130.954 198.907 130.949 198.941 130.945C199.031 130.935 199.122 130.924 199.212 130.911C199.233 130.908 199.254 130.904 199.275 130.901C202.545 130.397 205.397 127.836 206.325 124.655V130.406C206.325 130.73 206.588 130.992 206.912 130.992H211.926C212.25 130.992 212.513 130.73 212.513 130.406V104.278C212.513 103.954 212.25 103.691 211.926 103.691H206.325ZM206.325 124.268C205.112 125.278 203.544 125.658 201.866 125.772C201.85 125.773 201.833 125.775 201.818 125.776C201.706 125.782 201.595 125.785 201.483 125.785C197.283 125.785 193.814 122.216 193.814 117.893C193.814 116.873 194.009 115.903 194.353 115.011C195.469 112.115 198.209 110.064 201.42 110.064H206.325V124.268Z"
              fill="#003DFF"
            />
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M329.59 103.691H324.685C319.876 103.691 315.645 106.225 313.174 110.065C311.73 112.311 310.888 115.001 310.888 117.895C310.888 122.359 312.89 126.339 316.018 128.943C316.31 129.201 316.62 129.438 316.944 129.653C318.223 130.497 319.74 130.992 321.371 130.992C321.494 130.992 321.616 130.989 321.737 130.983C321.773 130.981 321.808 130.978 321.844 130.976C321.93 130.971 322.018 130.965 322.104 130.957C322.138 130.954 322.172 130.949 322.206 130.945C322.296 130.935 322.387 130.924 322.477 130.911C322.498 130.908 322.519 130.904 322.54 130.901C325.811 130.397 328.662 127.836 329.59 124.655V130.406C329.59 130.73 329.853 130.992 330.177 130.992H335.191C335.515 130.992 335.778 130.73 335.778 130.406V104.278C335.778 103.954 335.515 103.691 335.191 103.691H329.59ZM329.59 124.268C328.377 125.278 326.809 125.658 325.131 125.772C325.115 125.773 325.099 125.775 325.083 125.776C324.971 125.782 324.86 125.785 324.749 125.785C320.548 125.785 317.079 122.216 317.079 117.893C317.079 116.873 317.274 115.903 317.618 115.011C318.734 112.115 321.474 110.064 324.685 110.064H329.59V124.268Z"
              fill="#003DFF"
            />
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M248.055 103.691H243.149C238.34 103.691 234.109 106.225 231.639 110.065C230.466 111.889 229.69 114.007 229.44 116.29C229.382 116.817 229.353 117.352 229.353 117.895C229.353 118.438 229.383 119.003 229.445 119.544C229.871 123.332 231.746 126.666 234.483 128.944C234.774 129.202 235.084 129.439 235.409 129.654C236.687 130.498 238.204 130.993 239.836 130.993C241.625 130.993 243.278 130.404 244.625 129.405C246.245 128.254 247.497 126.567 248.054 124.657V129.655H248.043V130.757C248.043 132.929 247.475 134.562 246.319 135.665C245.164 136.767 243.232 137.319 240.526 137.319C239.42 137.319 237.663 137.26 235.892 137.079C235.611 137.05 235.349 137.228 235.268 137.499L233.998 141.786C233.896 142.13 234.124 142.484 234.478 142.535C236.618 142.841 238.706 143 239.912 143C244.776 143 248.381 141.931 250.741 139.797C252.877 137.867 254.037 134.935 254.241 130.994V104.28C254.241 103.956 253.979 103.693 253.655 103.693H248.054L248.055 103.691ZM248.055 110.065C248.055 110.065 248.12 123.901 248.055 124.322C246.854 125.293 245.359 125.673 243.73 125.783C243.714 125.784 243.697 125.786 243.681 125.787C243.57 125.794 243.459 125.797 243.347 125.797C243.216 125.797 243.086 125.794 242.955 125.787C238.937 125.578 235.545 122.082 235.545 117.894C235.545 116.874 235.74 115.904 236.084 115.012C237.2 112.116 239.939 110.065 243.15 110.065H248.056H248.055Z"
              fill="#003DFF"
            />
            <path
              d="M142.225 93.2763C128.648 93.2763 117.58 104.223 117.384 117.754C117.185 131.496 128.335 142.884 142.079 142.963C146.323 142.988 150.411 141.95 154.042 139.977C154.396 139.785 154.451 139.298 154.149 139.031L151.824 136.971C151.352 136.552 150.68 136.434 150.098 136.68C147.564 137.758 144.811 138.309 141.972 138.274C130.867 138.138 121.894 128.898 122.071 117.793C122.246 106.828 131.22 97.9631 142.225 97.9631H162.381V133.79L150.945 123.628C150.575 123.299 150.008 123.364 149.71 123.759C147.874 126.189 144.884 127.701 141.563 127.472C136.955 127.154 133.222 123.444 132.877 118.839C132.465 113.346 136.818 108.744 142.225 108.744C147.116 108.744 151.143 112.508 151.564 117.291C151.602 117.717 151.793 118.113 152.113 118.397L155.091 121.037C155.429 121.336 155.965 121.153 156.049 120.709C156.263 119.56 156.339 118.364 156.254 117.137C155.775 110.142 150.109 104.514 143.111 104.084C135.088 103.59 128.38 109.865 128.168 117.732C127.96 125.4 134.242 132.009 141.91 132.178C145.111 132.248 148.078 131.242 150.476 129.498L165.418 142.743C166.059 143.311 167.07 142.857 167.07 142.001V94.217C167.07 93.6959 166.648 93.2743 166.127 93.2743H142.225V93.2763Z"
              fill="#003DFF"
            />
            <path
              d="M116.415 166.498V153.777H120.96C122.096 153.777 123.083 153.949 123.921 154.293C124.77 154.626 125.476 155.085 126.038 155.67C126.612 156.244 127.036 156.898 127.312 157.633C127.599 158.367 127.742 159.13 127.742 159.922V160.301C127.742 161.058 127.599 161.804 127.312 162.539C127.036 163.273 126.612 163.939 126.038 164.536C125.476 165.132 124.77 165.609 123.921 165.965C123.083 166.32 122.096 166.498 120.96 166.498H116.415ZM121.115 156.049H118.859V164.226H121.115C121.975 164.226 122.716 164.054 123.335 163.709C123.955 163.354 124.431 162.866 124.764 162.246C125.097 161.626 125.263 160.915 125.263 160.112C125.263 158.861 124.896 157.874 124.162 157.151C123.427 156.416 122.411 156.049 121.115 156.049ZM140.656 166.756C139.52 166.756 138.533 166.556 137.695 166.154C136.857 165.752 136.163 165.23 135.612 164.587C135.072 163.933 134.671 163.233 134.407 162.487C134.143 161.73 134.011 161.001 134.011 160.301V159.922C134.011 159.153 134.149 158.39 134.424 157.633C134.699 156.875 135.113 156.187 135.664 155.567C136.226 154.936 136.92 154.437 137.746 154.069C138.573 153.691 139.543 153.501 140.656 153.501C141.746 153.501 142.704 153.691 143.531 154.069C144.368 154.437 145.063 154.936 145.613 155.567C146.164 156.187 146.577 156.875 146.853 157.633C147.14 158.39 147.283 159.153 147.283 159.922V160.301C147.283 161.001 147.146 161.73 146.87 162.487C146.606 163.233 146.199 163.933 145.648 164.587C145.109 165.23 144.42 165.752 143.582 166.154C142.756 166.556 141.78 166.756 140.656 166.756ZM140.656 164.484C141.505 164.484 142.239 164.289 142.859 163.899C143.479 163.497 143.955 162.963 144.288 162.298C144.632 161.632 144.804 160.909 144.804 160.129C144.804 159.303 144.632 158.562 144.288 157.908C143.955 157.243 143.479 156.72 142.859 156.342C142.239 155.963 141.505 155.774 140.656 155.774C139.795 155.774 139.055 155.963 138.435 156.342C137.815 156.72 137.333 157.243 136.989 157.908C136.656 158.562 136.49 159.303 136.49 160.129C136.49 160.909 136.656 161.632 136.989 162.298C137.322 162.963 137.798 163.497 138.418 163.899C139.049 164.289 139.795 164.484 140.656 164.484ZM160.129 166.756C158.982 166.756 158 166.556 157.186 166.154C156.382 165.752 155.722 165.23 155.206 164.587C154.701 163.945 154.328 163.25 154.087 162.504C153.846 161.747 153.726 161.012 153.726 160.301V159.922C153.726 159.153 153.846 158.39 154.087 157.633C154.34 156.864 154.724 156.169 155.24 155.55C155.757 154.93 156.411 154.437 157.203 154.069C157.995 153.691 158.942 153.501 160.043 153.501C161.168 153.501 162.155 153.708 163.004 154.121C163.853 154.534 164.53 155.108 165.035 155.842C165.54 156.577 165.845 157.438 165.948 158.425H163.486C163.348 157.564 162.964 156.91 162.333 156.462C161.713 156.003 160.95 155.774 160.043 155.774C159.205 155.774 158.5 155.963 157.926 156.342C157.364 156.709 156.933 157.22 156.635 157.874C156.348 158.528 156.204 159.28 156.204 160.129C156.204 160.955 156.354 161.695 156.652 162.349C156.95 163.004 157.392 163.526 157.978 163.916C158.563 164.295 159.28 164.484 160.129 164.484C161.07 164.484 161.862 164.255 162.505 163.796C163.159 163.325 163.555 162.671 163.693 161.833H166.154C166.04 162.74 165.73 163.566 165.225 164.312C164.731 165.058 164.054 165.655 163.193 166.102C162.344 166.538 161.323 166.756 160.129 166.756ZM178.219 166.756C177.037 166.756 176.044 166.533 175.241 166.085C174.437 165.637 173.829 165.012 173.416 164.209C173.003 163.394 172.796 162.441 172.796 161.351V153.863H175.241V161.489C175.241 162.395 175.493 163.124 175.998 163.675C176.515 164.214 177.255 164.484 178.219 164.484C179.16 164.484 179.883 164.214 180.388 163.675C180.904 163.136 181.162 162.407 181.162 161.489V153.863H183.607V161.351C183.607 162.441 183.4 163.394 182.987 164.209C182.574 165.012 181.966 165.637 181.162 166.085C180.371 166.533 179.389 166.756 178.219 166.756ZM191.289 166.429V153.863H194.629L197.779 161.368H198.089L201.222 153.863H204.613V166.429H202.186V156.479L199.105 163.864H196.609L193.527 156.531V166.429H191.289ZM212.534 166.429V153.863H220.142V155.928H214.927V159.01H219.833V161.076H214.927V164.364H220.28V166.429H212.534ZM227.608 166.429V153.863H231.619L236.904 164.398H237.128V153.863H239.435V166.429H235.407L230.122 155.894H229.881V166.429H227.608ZM249.836 166.429V156.015H246.203V153.863H255.912V156.015H252.28V166.429H249.836ZM260.385 166.429L264.672 153.863H268.665L273.072 166.429H270.559L269.406 163.09H263.931L262.83 166.429H260.385ZM264.62 161.024H268.7L266.961 155.911H266.324L264.62 161.024ZM281.179 166.429V156.015H277.546V153.863H287.255V156.015H283.623V166.429H281.179ZM294.061 166.429V153.863H296.506V166.429H294.061ZM310.366 166.756C309.23 166.756 308.243 166.556 307.405 166.154C306.568 165.752 305.873 165.23 305.322 164.587C304.783 163.933 304.381 163.233 304.117 162.487C303.853 161.73 303.721 161.001 303.721 160.301V159.922C303.721 159.153 303.859 158.39 304.135 157.633C304.41 156.875 304.823 156.187 305.374 155.567C305.936 154.936 306.631 154.437 307.457 154.069C308.283 153.691 309.253 153.501 310.366 153.501C311.457 153.501 312.415 153.691 313.241 154.069C314.079 154.437 314.773 154.936 315.324 155.567C315.875 156.187 316.288 156.875 316.563 157.633C316.85 158.39 316.994 159.153 316.994 159.922V160.301C316.994 161.001 316.856 161.73 316.581 162.487C316.317 163.233 315.909 163.933 315.358 164.587C314.819 165.23 314.131 165.752 313.293 166.154C312.466 166.556 311.491 166.756 310.366 166.756ZM310.366 164.484C311.216 164.484 311.95 164.289 312.57 163.899C313.189 163.497 313.666 162.963 313.999 162.298C314.343 161.632 314.515 160.909 314.515 160.129C314.515 159.303 314.343 158.562 313.999 157.908C313.666 157.243 313.189 156.72 312.57 156.342C311.95 155.963 311.216 155.774 310.366 155.774C309.506 155.774 308.765 155.963 308.146 156.342C307.526 156.72 307.044 157.243 306.7 157.908C306.367 158.562 306.2 159.303 306.2 160.129C306.2 160.909 306.367 161.632 306.7 162.298C307.032 162.963 307.509 163.497 308.128 163.899C308.76 164.289 309.506 164.484 310.366 164.484ZM324.176 166.429V153.863H328.187L333.472 164.398H333.696V153.863H336.003V166.429H331.974L326.69 155.894H326.449V166.429H324.176Z"
              fill="#003DFF"
            />
          </g>
          <defs>
            <filter
              id="filter0_f_1060_5545"
              x="483.125"
              y="-53.125"
              width="748.75"
              height="750"
              filterUnits="userSpaceOnUse"
              color-interpolation-filters="sRGB"
            >
              <feFlood flood-opacity="0" result="BackgroundImageFix" />
              <feBlend
                mode="normal"
                in="SourceGraphic"
                in2="BackgroundImageFix"
                result="shape"
              />
              <feGaussianBlur
                stdDeviation="15"
                result="effect1_foregroundBlur_1060_5545"
              />
            </filter>
            <linearGradient
              id="paint0_linear_1060_5545"
              x1="636.35"
              y1="-4.6229e-06"
              x2="636.35"
              y2="963.136"
              gradientUnits="userSpaceOnUse"
            >
              <stop offset="0.556379" stop-color="white" />
              <stop offset="1" stop-color="#CAD2EE" />
            </linearGradient>
            <radialGradient
              id="paint1_radial_1060_5545"
              cx="0"
              cy="0"
              r="1"
              gradientUnits="userSpaceOnUse"
              gradientTransform="translate(30.5972 686.941) rotate(-95.5495) scale(456.573 170.176)"
            >
              <stop stop-color="#00F0FF" />
              <stop offset="0.979984" stop-color="#0025FF" />
            </radialGradient>
            <radialGradient
              id="paint2_radial_1060_5545"
              cx="0"
              cy="0"
              r="1"
              gradientUnits="userSpaceOnUse"
              gradientTransform="translate(30.5972 686.941) rotate(-95.5495) scale(456.573 170.176)"
            >
              <stop stop-color="#00F0FF" />
              <stop offset="0.979984" stop-color="#0025FF" />
            </radialGradient>
            <radialGradient
              id="paint3_radial_1060_5545"
              cx="0"
              cy="0"
              r="1"
              gradientUnits="userSpaceOnUse"
              gradientTransform="translate(563.116 170.194) rotate(33.243) scale(906.036 904.394)"
            >
              <stop stop-color="#D9D9D9" />
              <stop offset="1" stop-color="#3A4FED" />
            </radialGradient>
            <radialGradient
              id="paint4_radial_1060_5545"
              cx="0"
              cy="0"
              r="1"
              gradientUnits="userSpaceOnUse"
              gradientTransform="translate(30.5972 686.941) rotate(-95.5495) scale(456.573 170.176)"
            >
              <stop stop-color="#00F0FF" />
              <stop offset="0.979984" stop-color="#0025FF" />
            </radialGradient>
            <clipPath id="clip0_1060_5545">
              <rect width="1200" height="630" fill="white" />
            </clipPath>
          </defs>
        </svg>
        <p
          style={{
            position: "absolute",
            width: "870px",
            height: "355px",
            top: "180px",
            left: "110px",
            fontSize: "64px",
            fontWeight: "600",
          }}
        >
          {title}
        </p>
      </div>
    ),
    // ImageResponse options
    {
      ...size,
    }
  );
}
